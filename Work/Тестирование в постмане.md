
#Scala 
#work 

1. Авторизация:
   нужно указать конкретный дев, например:
	  https://dev-app3.regionlab.kz/api/client/mobile/v2/auth

2. Получение токена авторизации:
   https://dev-app3.regionlab.kz/api/client/mobile/v2/auth-token
   тоже вводим нужное нам окружение
3. Получение x-location:
     /api/client/mobile/v2.1/x-location?lat={{lat}}&lon={{lon}}  
     в lat и lon вводим координаты нужной нам геозоны, получить их можем в профилях клиентского приложения:
 https://dev3-management.regionlab.kz/client-app-profile

![[Снимок экрана 2024-04-24 115135.png]]
если допустим это Талгар, то выбираем в яндекс картах нужный нам lat и lon координаты и вставляем в переменные в постмане.

либо находим их в таблице в dbveavere 
client_app_profile.tariff 


статья в jira по работе с тарифами:
https://hivetaxi.atlassian.net/wiki/spaces/HIVETAXI/pages/2025750549


4. получение тарифа:

/api/client/mobile/v2/tariffs?lat={{lat}}&lon={{lon}}


если не создаются заказы после получения тарифа, то нужно его проверить через менеджмент:

https://dev3-management.regionlab.kz/test-requests/management

Должны прийти на отпарвку запроса пустые скобки квадратные, 
если приходит ответ не пустой, то надо редактировать тариф:
указать параметры, допустим:
{
    "profileId": "622063d1-0da9-4c5a-9bab-d3d0b808d2a7",
    "xLocation": "0ab0dd01-0e3e-4364-999c-3772f63d62d4",
    "class": "standard"
}
![[Снимок экрана 2024-04-24 121408.png]]


для создания договорных поездок обязательно указать параметр класса - 
"standart"

также в paymentMethod, обязательно должно стоять:
kind - cash



ььььььььь

SELECT * FROM client_orders.client_order_details WHERE id = '66278dd419784e13ec814a59' and client_id = '011f5923-e98d-4516-9b83-d2efa0997e88'; - пример запроса из DBVEAVERA


если после всего не создается договорной заказ, то нужно утсановить правильные x-location и profileId
берем их из профили клиентского приложения, выбираем нужный профиль dev и заходим в нетворк:

![[Снимок экрана 2024-04-24 165956.png]]
zoneId - это и есть xlocation

и потом их устанавливаем в запросе ClientAppProfiles.editHaggleSettings в менеджменте:

![[Снимок экрана 2024-04-24 170424.png]]

также устанавливаем нужные значения в postman:

![[Снимок экрана 2024-04-24 170424 1.png]]

xLocation - это и есть zoneId


можно посмотреть какие геозоны отвечают за конкретные уулицы на менеджменте:


![[Снимок экрана 2024-05-30 122622.png]]


tariff id можно также получить с менеджмента:

![[Снимок экрана 2024-05-30 123501.png]]

![[00bc0583-565d-40e4-8738-9d7260e3d516.jpg]]



Посмотреть список контрагентов на окружении и добавление также нового контрагента:

![[Снимок экрана 2024-05-30 131706.png]]

